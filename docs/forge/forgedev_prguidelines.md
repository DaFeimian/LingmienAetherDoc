---
title: 拉取请求指南
order: 1
toc: content
group:
  title: 为Forge做贡献
  order: 9999
---
Pull Request 指南
================

模组建立在 Forge 之上，但有些功能 Forge 不支持，这限制了模组的开发者。  
当模组开发者遇到这种情况时，他们可以对 Forge 做出相应更改，并将此更改作为 Pull Request 提交到 Github。

为了有效利用您和 Forge 团队的时间，建议在准备 Pull Request 时遵循一些粗略的指导原则。以下几点是编写优秀 Pull Request 时需要牢记的最重要方面。

什么是 Forge？
----------------

从高层次来看，Forge 是 Minecraft 上的一个模组兼容层。  
早期的模组直接修改 Minecraft 的代码（类似于现在的核心模组），但当多个模组修改同一部分代码时，会发生冲突。当某个模组的行为改变到其他模组无法预见的程度时（类似于核心模组现在的操作），也会导致难以解决的问题，给人造成很多麻烦。

通过使用像 Forge 这样的平台，模组可以集成常见的更改以避免冲突。  
Forge 还包括支持模组常见功能的结构，例如能力、注册表等，这使得模组之间协作更加顺畅。

在编写优秀的 Forge Pull Request 时，您需要了解 Forge 的低层次结构。  
Forge 中有两种主要类型的代码：Minecraft 补丁和 Forge 代码。

补丁
--------

补丁是对 Minecraft 源代码的直接修改，旨在尽量减少改变。  
每次 Minecraft 代码更改时，所有的 Forge 补丁都需要仔细查看并正确应用到新代码中。  
这意味着改动较大的补丁不易维护，Forge 力图避免这些情况，并尽量保持补丁的小型化。  
除了确保代码意义明确之外，补丁的审查重点在于缩小代码体积。

有多种策略可以创建小型补丁，评审通常会指出更好的实现方法。  
Forge 补丁常常插入触发事件或代码钩子的单行代码，如果事件符合某些条件，就会影响后续代码。  
这使得大部分代码可以存在于补丁之外，从而保持补丁小而简单。

有关创建补丁的详细信息，请参见 [GitHub wiki][patches]。

Forge 代码
----------

除了补丁之外，Forge 代码就是普通的 Java 代码。可以是事件代码、兼容性功能或其他不直接编辑 Minecraft 代码的内容。
当 Minecraft 更新时，Forge 代码也必须更新，但由于它不直接与 Minecraft 代码纠缠在一起，因此更新要容易得多。

由于这段代码是独立存在的，因此没有补丁那样的大小限制。

除了确保代码合理之外，评审还会关注代码的整洁性：具有正确的格式和 Java 文档。

解释你的需求
----------------

所有 Pull Request 都需要回答一个问题：为什么这是必要的？  
增加到 Forge 的任何代码都需要维护，更多的代码意味着更多潜在的漏洞，因此需要合理的理由来增加代码。

常见的 Pull Request 问题是没有说明原因，或只提供模棱两可的示例来描述 Pull Request 的理论用途。  
这只会延缓 Pull Request 过程。  
对一般情况的明确解释是好的，但也请给出一个具体的示例，说明您的模组为何需要这个 Pull Request。

有时会有更好的方法来实现您的目标，或者根本无需通过 Pull Request 来实现。在完全排除其他可能性之前，代码更改不会被接受。

展示其效果
------------------

您提交给 Forge 的代码应该完美无瑕，您需要说服评审人员。  

一个最好的方法是向 Forge 添加示例模组或 JUnit 测试，来利用新代码并展示其效果。  

有关设置和运行带有示例模组的 Forge 环境的信息，请参见[此指南][forgeenv]。

Forge 中的重大更改
-------------------------

Forge 不能做出会破坏依赖它的模组的更改。  
这意味着 Pull Request 必须确保它们不会破坏与之前 Forge 版本的二进制兼容性。  
一个破坏二进制兼容性的更改被称为重大更改。

这种更改有一些例外情况：

* Forge 在新的 Minecraft 版本开始时接受重大更改，因为 Minecraft 自身已经为模组开发者带来了重大更改。  
* 有时需要在上述时间窗口之外进行紧急重大更改，但这很少见，并可能给整个舞弊的 Minecraft 社区带来依赖问题。

除了这些特殊情况之外，带有重大更改的 Pull Request 均不被接受。它们必须适应旧行为，或等待 Minecraft 的下一个版本。

耐心、文明和移情
--------------------------------

提交 Pull Request 时，您通常需要经历代码审查并进行多次修改，才可成为理想的 Pull Request。  
请记住，代码审查不是对您的评价。代码中的漏洞并不是您的个人问题。没有人是完美的，这就是我们协作的原因。 

消极态度无助于解决问题。威胁放弃 Pull Request 转而编写核心模组的做法只会让人不快，并影响模组生态系统。  
协作时，重要的是假定审查您 Pull Request 的人的善意，并不将事情视为个人问题。

审查
------

如果您尽量理解 Pull Request 过程中缓慢且追求完美的特性，我们也会尽量理解您的观点。

您的 Pull Request 在经过大家的努力审查和清理之后，会被标记为交由 Lex 进行最终审查，最终由他决定该项目中是否包含您的代码。

[patches]: https://github.com/MinecraftForge/MinecraftForge/wiki/If-you-want-to-contribute-to-Forge#conventions-for-coding-patches-for-a-minecraft-class-javapatch
[forgeenv]: ./index.md