---
title: 版本控制
order: 3
toc: content
group:
  title: 入门指南
  order: 9984
---
版本控制
==========

在常规项目中，[语义化版本控制][semver]经常使用（格式为 `MAJOR.MINOR.PATCH`）。然而，在模组的情况下，使用 `MCVERSION-MAJORMOD.MAJORAPI.MINOR.PATCH` 格式可能更有益，因为它可以区分导致世界性改变和API改变的不同模组变更。

!!! important
    Forge 使用 [Maven版本范围][cmpver] 来比较版本字符串，这与语义化版本控制2.0.0规范不完全兼容，例如“预发布”标签。

示例
--------

以下是可以增加各个变量的示例列表。

* `MCVERSION`
  * 始终与模组所对应的Minecraft版本匹配。
* `MAJORMOD`
  * 移除物品、方块、方块实体等。
  * 改变或移除先前存在的机制。
  * 更新到新的Minecraft版本。
* `MAJORAPI`
  * 改变枚举的顺序或变量。
  * 改变方法的返回类型。
  * 完全删除公共方法。
* `MINOR`
  * 增加物品、方块、方块实体等。
  * 增加新机制。
  * 弃用公共方法。（这不是一个 `MAJORAPI` 增量，因为它不会破坏API。）
* `PATCH`
  * 错误修正。

在增加任意变量时，所有较小的变量应重置为 `0`。例如，如果 `MINOR` 增加，`PATCH` 将变为 `0`。如果 `MAJORMOD` 增加，所有其他变量将变为 `0`。

### 开发中

如果您处于模组的初始开发阶段（在任何正式发布之前），则 `MAJORMOD` 和 `MAJORAPI` 应始终为 `0`。每次构建模组时，仅应更新 `MINOR` 和 `PATCH`。一旦构建正式版本（大多数情况下具有稳定的API），应将 `MAJORMOD` 增加到版本 `1.0.0.0`。有关进一步的开发阶段，请参阅本文档中的[预发布][pre]和[发布候选版][rc]部分。

### 多个Minecraft版本

如果模组升级到一个新的Minecraft版本，而旧版本仅接收错误修复，则 `PATCH` 变量应根据升级前的版本更新。如果模组仍在旧版本和新版本的Minecraft中处于积极开发中，建议在**两个**构建号后附加版本。例如，如果由于Minecraft版本更改，模组升级到版本 `3.0.0.0`，旧模组也应更新为 `3.0.0.0`。旧版本将变为例如版本 `1.7.10-3.0.0.0`，而新版本将变为 `1.8-3.0.0.0`。如果在为较新的Minecraft版本构建时没有任何更改，除Minecraft版本外的所有变量都应保持不变。

### 最终版本

在停止支持某个Minecraft版本时，该版本的最后一次构建应获得 `-final` 后缀。这表示该模组将不再支持指定的 `MCVERSION`，玩家应该升级到模组的较新版本以继续接收更新和错误修复。

### 预发布

也可以将开发中的功能进行预发布，这意味着发布还未完成的新功能。这些可以视为某种“测试版”。这些版本应加上 `-betaX`，其中 `X` 是预发布的编号。（此指南不使用 `-pre`，因为在撰写本文时，它不是 `-beta` 的有效别名。）注意，已经发布的版本和初始发布之前的版本不能进入预发布；变量（通常是 `MINOR`，但 `MAJORAPI` 和 `MAJORMOD` 也可以进行预发布）应在添加 `-beta` 后缀之前进行相应更新。初始发布之前的版本只是开发中的构建。

### 发布候选版

发布候选版作为实际版本更改前的预发布。这些版本应附加 `-rcX`，其中 `X` 是发布候选版的编号，理论上仅在错误修复时增加。已经发布的版本不能接收发布候选版；变量（主要是 `MINOR`，但 `MAJORAPI` 和 `MAJORMOD` 也可以进行更改）应在添加 `-rc` 后缀之前进行相应更新。在将发布候选版作为稳定版本发布时，它可以与最后一个发布候选版完全相同，也可以有一些额外的错误修复。

[semver]: https://semver.org/
[cmpver]: https://maven.apache.org/ref/3.5.2/maven-artifact/apidocs/org/apache/maven/artifact/versioning/ComparableVersion.html
[pre]: #pre-releases
[rc]: #release-candidates