---
title: 实体
order: 2
toc: content
group:
  title: 网络通信
  order: 9989
---
实体
====

除了常规的网络消息外，还有各种其他系统可用于处理实体数据的同步。

生成数据
--------

通常，模组实体的生成由 Forge 单独处理。

!!! 注意
    这意味着简单地扩展原版实体类可能不会继承其所有行为。您可能需要自己实现某些原版行为。

您可以通过实现以下接口，向 Forge 发送的生成数据包中添加额外的数据。

### IEntityAdditionalSpawnData

如果您的实体有一些客户端所需但不会随时间变化的数据，则可以使用此接口将其添加到实体生成数据包中。`#writeSpawnData` 和 `#readSpawnData` 控制数据应如何编码到网络缓冲区或从中解码。

动态数据
--------

### 数据参数

这是从服务器到客户端同步实体数据的主要原版系统。因此，有许多原版示例可供参考。

首先，您需要为希望保持同步的数据创建一个 `EntityDataAccessor<T>`。这应该作为 `static final` 字段存储在您的实体类中，获取方式是调用 `SynchedEntityData#defineId`，并传入实体类和该类型数据的序列化器。可用的序列化器实现可以在 `EntityDataSerializers` 类中找到作为静态常量。

!!! 警告
    您应当__只__为您自己的实体创建数据参数，_且仅在该实体的类中_。
    向您无法控制的实体添加参数可能会导致用于通过网络发送数据的 ID 失去同步，从而导致难以调试的崩溃。

然后，覆盖 `Entity#defineSynchedData`，并对每个数据参数调用 `this.entityData.define(...)`，传入参数和要使用的初始值。请务必首先调用 `super` 方法！

之后，您可以通过实体的 `entityData` 实例获取和设置这些值。所做的更改将自动同步到客户端。